<!DOCTYPE html>
<html>
<head>
    <title>Candlestick Chart</title>
    <!-- Required Libraries -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/luxon"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-luxon"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-chart-financial"></script>
    <style>
        #chart-container {
            width: 100%;
            max-width: 1000px;
            margin: 20px auto;
        }
        canvas {
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        #resetZoom {
            display: block;
            margin: 10px auto;
            padding: 8px 16px;
            background: #2196F3;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }
    </style>
</head>
<body>
    <div id="chart-container">
        <button id="resetZoom">Reset Zoom</button>
        <canvas id="myChart"></canvas>
    </div>

<script>
// Sample OHLC data (replace with your actual data source)
const csvData = `date,open,high,low,close
2023-01-01,100,110,95,105
2023-01-02,105,115,100,110
2023-01-03,110,120,105,115
2023-01-04,115,125,110,120
2023-01-05,120,130,115,125`;

// Parse CSV data
function parseData(csv) {
    const lines = csv.split('\n').slice(1);
    return lines.map(line => {
        const [date, open, high, low, close] = line.split(',');
        return {
            x: luxon.DateTime.fromISO(date).toJSDate(),
            o: parseFloat(open),
            h: parseFloat(high),
            l: parseFloat(low),
            c: parseFloat(close)
        };
    }).filter(d => !isNaN(d.o));
}

// Create chart
function createChart(data) {
    console.log(data);
    const ctx = document.getElementById('myChart').getContext('2d');
    
    return new Chart(ctx, {
        type: 'candlestick',
        data: {
            datasets: [{
                label: 'Price',
                data: data,
                color: {
                    up: '#4CAF50',    // Green for bullish candles
                    down: '#F44336',  // Red for bearish candles
                    unchanged: '#999' // Grey for neutral
                },
                borderColor: 'rgba(0, 0, 0, 0.3)',
                borderWidth: 1
            }]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
                zoom: {
                    pan: {
                        enabled: true,
                        mode: 'x',
                        modifierKey: null
                    },
                    zoom: {
                        wheel: { enabled: true },
                        pinch: { enabled: true },
                        mode: 'x'
                    }
                }
            },
            scales: {
                x: {
                    type: 'time',
                    time: {
                        unit: 'day',
                        tooltipFormat: 'MMM dd, yyyy'
                    },
                    ticks: {
                        source: 'auto',
                        maxTicksLimit: 30 // Show up to 30 daily ticks (adjust as needed)
                    }
                },
                y: {
                    beginAtZero: false,
                    title: {
                        display: true,
                        text: 'Price'
                    }
                }
            }
        }
    });
    console.log(data);
}

// Initialize chart
const chartData = parseData(csvData);
const myChart = createChart(chartData);

// Reset zoom button
document.getElementById('resetZoom').addEventListener('click', () => {
    myChart.resetZoom();
});
</script>
</body>
</html>
